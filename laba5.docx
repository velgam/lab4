\documentclass{article}
\usepackage{amsmath}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\begin{document}

\section*{Лабораторная работа №5. ЦЕЛОЧИСЛЕННОЕ ЛИНЕЙНОЕ ПРОГРАММИРОВАНИЕ. Метод Гомори}

\subsection*{Вариант 5}

\subsubsection*{Модель задачи}

Математическая модель задачи:

\[
f = 150x_1 + 480x_2 + 330x_3 + 500x_4 \to \max
\]

при ограничениях:

\[
\begin{cases}
70x_1 + 140x_2 + 130x_3 + 150x_4 \leq 850 \\
0 \leq x_j \leq 10,\quad j = 1,2,3,4 \\
x_j - \text{целые},\quad j = 1,2,3,4
\end{cases}
\]

\subsubsection*{Решение методом Гомори}

\textbf{1. Решение задачи без учёта целочисленности}

В системе Matlab выполняем:

\begin{verbatim}
>> f = [-150 -480 -330 -500];
>> A = [70 140 130 150];
>> b = 850;
>> lb = zeros(4,1);
>> ub = [10;10;10;10];
>> options = optimset('LargeScale','off','Simplex','on');
>> [x,fval] = linprog(f,A,b,[],[],lb,ub,[],options);
Optimization terminated.
>> x
x =
         0
    6.0714
         0
         0
>> fval
fval =
  -2.9143e+03
\end{verbatim}

Получили решение: $x_1 = 0$, $x_2 = 6.0714$, $x_3 = 0$, $x_4 = 0$ \\
Значение целевой функции: $f = 2914.3$

\textbf{2. Первое дополнительное ограничение}

Вводим дополнительную переменную $x_5$:

\[
70x_1 + 140x_2 + 130x_3 + 150x_4 + x_5 = 850
\]

Выбираем уравнение для переменной $x_2 = 6.0714$:

\[
x_2 + \frac{70}{140}x_1 + \frac{130}{140}x_3 + \frac{150}{140}x_4 + \frac{1}{140}x_5 = \frac{850}{140}
\]

\[
x_2 + 0.5x_1 + 0.9286x_3 + 1.0714x_4 + 0.007143x_5 = 6.0714
\]

Дробные части коэффициентов:
\begin{align*}
\{0.5\} &= 0.5 \\
\{0.9286\} &= 0.9286 \\ 
\{1.0714\} &= 0.0714 \\
\{0.007143\} &= 0.007143 \\
\{0.0714\} &= 0.0714
\end{align*}

Строим ограничение Гомори:

\[
-0.5x_1 - 0.9286x_3 - 0.0714x_4 - 0.007143x_5 \leq -0.0714
\]

Выражаем $x_5$ через исходные переменные:

\[
x_5 = 850 - 70x_1 - 140x_2 - 130x_3 - 150x_4
\]

После подстановки получаем:

\[
x_1 + 2x_3 + x_4 \leq 12
\]

\textbf{3. Решение с первым дополнительным ограничением}

\begin{verbatim}
>> A = [70 140 130 150; 1 0 2 1];
>> b = [850; 12];
>> [x,fval] = linprog(f,A,b,[],[],lb,ub,[],options);
Optimization terminated.
>> x
x =
         0
    5.5000
    1.0000
         0
>> fval
fval =
  -2.9100e+03
\end{verbatim}

Решение: $x_1 = 0$, $x_2 = 5.5$, $x_3 = 1.0$, $x_4 = 0$ \\
Значение целевой функции: $f = 2910$

\textbf{4. Второе дополнительное ограничение}

Выбираем уравнение для переменной $x_2 = 5.5$. Вводим переменные $x_5$, $x_6$:

\[
\begin{cases}
70x_1 + 140x_2 + 130x_3 + 150x_4 + x_5 = 850 \\
x_1 + 2x_3 + x_4 + x_6 = 12
\end{cases}
\end{verbatim}

В Matlab находим обратную матрицу для базиса $\{x_2, x_3\}$:

\begin{verbatim}
>> B = [140 130; 0 2];
>> D = inv(B);
>> E = [70 140 130 150 1 0 850; 1 0 2 1 0 1 12];
>> S = D*E
S =
    0.5000    1.0000         0    1.0714    0.0071   -0.6500    5.5000
    0.5000         0    1.0000   -0.0357   -0.0036    0.8250    1.0000
\end{verbatim}

Из второго уравнения (для $x_3$):

\[
x_3 + 0.5x_1 - 0.0357x_4 - 0.00357x_5 + 0.825x_6 = 1
\]

Дробные части: $\{0.5\} = 0.5$, $\{0.0357\} = 0.0357$, $\{0.00357\} = 0.00357$, $\{0.825\} = 0.825$, $\{0\} = 0$

Ограничение Гомори:

\[
-0.5x_1 - 0.0357x_4 - 0.00357x_5 - 0.175x_6 \leq 0
\]

После подстановки $x_5$, $x_6$ получаем:

\[
x_1 + x_4 \leq 10
\]

\textbf{5. Решение с двумя дополнительными ограничениями}

\begin{verbatim}
>> A = [70 140 130 150; 1 0 2 1; 1 0 0 1];
>> b = [850; 12; 10];
>> [x,fval] = linprog(f,A,b,[],[],lb,ub,[],options);
Optimization terminated.
>> x
x =
         0
    5.4286
    1.0000
    1.0000
>> fval
fval =
  -2.9054e+03
\end{verbatim}

Решение: $x_1 = 0$, $x_2 = 5.4286$, $x_3 = 1.0$, $x_4 = 1.0$ \\
Значение целевой функции: $f = 2905.4$

\textbf{6. Третье дополнительное ограничение}

Для переменной $x_2 = 5.4286$ строим новое ограничение. После вычислений получаем:

\[
x_2 + x_3 \leq 6
\]

\textbf{7. Финальное решение}

\begin{verbatim}
>> A = [70 140 130 150; 1 0 2 1; 1 0 0 1; 0 1 1 0];
>> b = [850; 12; 10; 6];
>> [x,fval] = linprog(f,A,b,[],[],lb,ub,[],options);
Optimization terminated.
>> x
x =
    1.0000
    5.0000
    1.0000
    1.0000
>> fval
fval =
  -2.9000e+03
\end{verbatim}

\subsection*{Оптимальное целочисленное решение}

\[
x_1 = 1,\quad x_2 = 5,\quad x_3 = 1,\quad x_4 = 1
\]

Максимальное значение целевой функции:

\[
f = 150\times1 + 480\times5 + 330\times1 + 500\times1 = 150 + 2400 + 330 + 500 = 3380
\]

\subsection*{Выводы}

В ходе лабораторной работы:
\begin{itemize}
\item Построена математическая модель задачи целочисленного линейного программирования
\item Реализован метод Гомори для нахождения целочисленного решения
\item Потребовалось три дополнительных ограничения для получения целочисленного плана
\item Найдено оптимальное решение: перевезти 1 упаковку товара A1, 5 упаковок A2, по 1 упаковке A3 и A4
\item Максимальная стоимость перевезенного груза: 3380 рублей
\end{itemize}

\end{document}